<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LPW: 常见问题</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="tutorial-utils.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.bootcdn.net/ajax/libs/mathjax/2.7.7/MathJax.js"></script>
<link href="lpv_stylesheet.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 100px;">
  <td id="projectlogo" style="padding-left: 1em; text-align: center; vertical-align: middle;"><a href="index.html"><img alt="Logo" src="lpw_logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em; vertical-align: bottom; padding-bottom: 5px; ">
   <!--<div id="projectname">LPW-->
   <!--</div>-->
   <div id="projectbrief">Leaper WaferScan Toolkit</div>
   <div id="projectbrief"><a href="../../cn/html/index.html">中文</a> / <a href="../../en/html/index.html">English</a></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'搜索','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','搜索');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">常见问题 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_Z__stonewall_doc_cn_t99_faq"></a> <br  />
</p>
<h4><a class="anchor" id="faq1"></a>
Q1. C++ 编译错误 C3506：没有为 LIBID XXX 注册的类型库</h4>
<blockquote class="doxtable">
<p>该错误表示对应平台的 LPW 模块在该机器上并未成功注册。</p><ol type="1">
<li>首先，确认 LPW 所在的文件夹路径**不包含任何特殊字符**，如 @ ( ) * &amp; 。命名该路径中包含特殊字符的文件夹。</li>
<li>重新注册 LPW 模块，以管理员运行 <b>runner/reg_run_as_admin.bat</b> 脚本。 </li>
</ol>
</blockquote>
<h4><a class="anchor" id="faq2"></a>
Q2. C++ 编译错误 MSB8036: 找不到 Windows SDK 版本 XX.XX</h4>
<blockquote class="doxtable">
<p>如果 Visual Studio 或 MSBuild 在预期位置找不到项目请求的 Windows SDK，会发生此错误。<br  />
 演示程序工程的目标平台为 10.0.16299.0 版本。若您并未安装对应的 Windows SDK，可修改工程对应的目标平台。右键工程打开工程配置界面，在 <b>配置属性 &gt; 常规 &gt; 目标平台</b> ，修改为已安装的版本。 </p>
</blockquote>
<h4><a class="anchor" id="faq3"></a>
Q3. C++ 编译错误 MSB8020: 无法找到 Visual Studio XXX 的生成工具(平台工具集 =“vXXX”)</h4>
<blockquote class="doxtable">
<p>若要解决此问题，请将项目升级为使用当前 Visual Studio 工具集，或使用 Visual Studio 安装程序安装指定的生成工具集。<br  />
 演示程序工程使用 Visual Studio 2017 (v141) 工具集。如您并未安装 VS 2017 或者 2015，可修改工程对应的平台工具集。右键工程打开工程配置界面，在 <b>配置属性 &gt; 常规 &gt; 平台工具集</b> ，修改为已安装的版本。 </p>
</blockquote>
<h4><a class="anchor" id="faq4"></a>
Q4. C++ 编译错误 C10083: 无法打开包括文件: "afxwin.h": 找不到文件或目录</h4>
<blockquote class="doxtable">
<p>"afxwin.h" 包含在 MFC 库中。编译 MFC demo 程序，需先安装 MFC 库。 注意：任何 Express 版本的 VC 均不包含 MFC 库，需使用 VC 的付费或社区版本。 </p>
</blockquote>
<h4><a class="anchor" id="faq5"></a>
Q5. C# 编译错误 CS0246: 找不到类型或命名空间名称 'LPVXXXLib' （是否缺少 using 指令或程序集引用?）</h4>
<blockquote class="doxtable">
<p>与 <a href="#faq1">Q1</a> 相同，其原因为对应平台的 LPW 模块在该机器上并未成功注册。请按相应步骤排查和解决问题。 </p>
</blockquote>
<h4><a class="anchor" id="faq6"></a>
Q6. C++ 运行时调用 CreateInstance 失败，返回错误 0x800401F0 尚未调用 CoInitialize</h4>
<blockquote class="doxtable">
<p>需要在程序开始处调用 CoInitializeEx，结束处调用 CoUnitialize。</p>
<p>对于多线程程序，对于需求创建和使用 LPW 类和方法的<b>每个线程</b>，需要在线程开始处调用 CoInitializeEx，结束处调用 CoUnitialize。</p>
<p>需要在创建和使用 LPW 模块之前调用初始化。</p>
<p>以 MFC 程序为例，推荐的调用位置为 MFC 程序的 InitInstance 和 ExitInstance 方法中。</p>
<p>例如: </p><div class="fragment"><div class="line">BOOL CMFCApp::InitInstance()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// 你需要根据应用程序的实际情况选择 COINIT_MULTITHREADED 或 COINIT_APARTMENTTHREADED</span></div>
<div class="line">    <span class="comment">// 如，MFC 使用 COINIT_APARTMENTTHREADED，其余情况可使用 COINIT_MULTITHREADED</span></div>
<div class="line">    <span class="comment">// 如果你并不确定，请仔细阅读文档 https://docs.microsoft.com/zh-cn/windows/win32/learnwin32/initializing-the-com-library</span></div>
<div class="line">    CoInitializeEx(NULL, COINIT_APARTMENTTHREADED);</div>
<div class="line">    <span class="comment">// etc.</span></div>
<div class="line">    CWinApp::InitInstance();</div>
<div class="line">}</div>
<div class="line">INT CMFCApp::ExitInstance()</div>
<div class="line">{</div>
<div class="line">    CoUninitialize();</div>
<div class="line">    <span class="keywordflow">return</span> CWinApp::ExitInstance();</div>
<div class="line">}</div>
</div><!-- fragment --> </blockquote>
<h4><a class="anchor" id="faq7"></a>
Q7. C++ 运行时调用 CreateInstance 失败，返回 False 且 m_pInterface 为空指针</h4>
<blockquote class="doxtable">
<p>1. 确认和排查相关模块是否成功注册，参考 <a href="#faq1">Q1</a> 步骤。</p><ol type="1">
<li>确认所在线程是否正常初始化 COM，参考 <a href="#faq6">Q6</a> 步骤。 </li>
</ol>
</blockquote>
<h4><a class="anchor" id="faq8"></a>
Q8. C# 及其他 .net 调用 LPW 显示控件，编辑器报错：找不到 'AxLPVDisplayLib.AxLDisplay'，请确保已引用包含此类型的程序集。</h4>
<blockquote class="doxtable">
<p>对 x86 平台，只需重新编译该程序的 x86(32bit) 平台，然后重启 Visual Studio。</p>
<p>对 x64 平台，因为 Visual Studio 本身是 32 位的，其不能使用 x64 版本的控件（如 LDisplay 控件）进行图形化编辑。解决方法概括来说是保证你的 Visual Studio 启动后第一次打开包含 LPW 显示控件的 UI 文件 (比如 demo 工程 CSharpDisplay 中的 CSharpDisplay.cs) 时，用的是 x86 的配置，之后在保持 Visual Studio 不关闭的情况下，可以随意打开这个 cs 文件不会报错。但是，一旦报了一次问题中所描述的错误之后，不重启 Visual Studio 是无法解决的。因此，报错后的一种典型操作流程如下：</p><ol type="1">
<li>保证 LPW 模块的32位版本和64位版本都已经正常注册。</li>
<li>在 Visual Studio 关闭前，切换配置为 x86，再关闭 Visual Studio。</li>
<li>用 Visual Studio 打开包含 LPW 显示控件的解决方案或工程。</li>
<li>确认此时配置为 x86，并打开 UI 文件，若打开时仍报错则重新从2开始进行操作（证明你没有按照234的内容进行操作）。</li>
<li>再切换配置为 x64，之后在重启 Visual Studio 之前，均可随意打开 UI 文件而不会发生错误。 </li>
</ol>
</blockquote>
<h4><a class="anchor" id="faq9"></a>
Q9. C++ 创建显示控件失败，调用 Create 接口返回 False</h4>
<blockquote class="doxtable">
<p>1. 确认和排查 LDisplay 模块是否成功注册，参考 <a href="#faq1">Q1</a> 步骤。</p><ol type="1">
<li>确认创建控件的线程以 COINIT_APARTMENTTHREADED 初始化，ActiveX 控件要求以 STA 模式初始化，其所在线程不能使用 COINIT_MULTITHREADED 模式。注意：您仍旧可以在其他线程以 COINIT_MULTITHREADED 初始化。</li>
<li>对于 MFC 程序，确认是否已在应用程序的 InitInstance 函数中调用 AfxEnableControlContainer() 以启用对 ActiveX 控件的调用。 更多信息，请查阅微软官方 <a href="https://docs.microsoft.com/zh-cn/cpp/mfc/reference/ole-initialization">OLE 初始化</a> 相关文档。 </li>
</ol>
</blockquote>
<h4><a class="anchor" id="faq10"></a>
Q10. 注册脚本提示错误 Register failed, error code = 3.</h4>
<blockquote class="doxtable">
<p>该错误表示注册工具无法正常加载 LPW 模块。<br  />
 通常是由于没有安装正确版本的 Visual C++ Redistributable Package。需从<a href="https://support.microsoft.com/en-us/topic/the-latest-supported-visual-c-downloads-2647da03-1eea-4433-9aff-95f26a218cc0">微软官方网站</a>下载安装，也可以从我们提供的<a href="http://fileserver.hzleaper.com:8086/f/9c787cde6b8b475e97fc/">下载链接</a>下载。 </p>
</blockquote>
<h4><a class="anchor" id="faq11"></a>
Q11. 注册脚本提示错误 Register failed, error code = 5.</h4>
<blockquote class="doxtable">
<p>该错误表示注册工具无法正常执行注册任务。<br  />
 可能是由于未以管理员运行注册脚本，或者 LPW 所在的目录路径不合法。需关闭脚本，再次按照 <a href="#faq1">Q1</a> 提供的步骤确认并重新注册。 </p>
</blockquote>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
© 2022 <a href="http://www.hzleaper.com/">杭州利珀科技有限公司</a>
</small></address>
<script type="text/javascript">
//<![CDATA[
addTutorialsButtons();
//]]>
</script>
</body>
</html>

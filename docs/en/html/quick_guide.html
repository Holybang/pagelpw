<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LPW: Quick Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="tutorial-utils.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.bootcdn.net/ajax/libs/mathjax/2.7.7/MathJax.js"></script>
<link href="lpv_stylesheet.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 100px;">
  <td id="projectlogo" style="padding-left: 1em; text-align: center; vertical-align: middle;"><a href="index.html"><img alt="Logo" src="lpw_logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em; vertical-align: bottom; padding-bottom: 5px; ">
   <!--<div id="projectname">LPW-->
   <!--</div>-->
   <div id="projectbrief">Leaper WaferScan Toolkit</div>
   <div id="projectbrief"><a href="../../cn/html/index.html">中文</a> / <a href="../../en/html/index.html">English</a></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Quick Guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_Z__stonewall_doc_en_t01_quick_guide"></a> <br  />
</p>
<h1><a class="anchor" id="autotoc_md4"></a>
Install with Zip Package</h1>
<ol type="1">
<li>Extract the lpw_sdk_x.x.x.x.zip file to any directory.</li>
<li><em>[Optional]</em> If you don't have Visual C++ Redistributable Package 14 or higher installed on your machine, you may have to download then install one from Microsoft's official website(<a href="https://support.microsoft.com/en-us/topic/the-latest-supported-visual-c-downloads-2647da03-1eea-4433-9aff-95f26a218cc0">https://support.microsoft.com/en-us/topic/the-latest-supported-visual-c-downloads-2647da03-1eea-4433-9aff-95f26a218cc0</a>), or <a href="http://fileserver.hzleaper.com:8086/f/9c787cde6b8b475e97fc/">our link</a>.</li>
<li>You should then manually register the LPW dlls.</li>
</ol>
<h3><a class="anchor" id="autotoc_md5"></a>
Manual Registration</h3>
<ol type="1">
<li>RMC the <b>reg_run_as_admin.bat</b> file under the root runner folder, click Run as administrator. It will then register all licensed LPW modules of all platforms(both x86 and x64).</li>
<li>Double click to <b>run the check_lpv_module_path.bat</b> file under the root runner folder, it will print out the path of all well-registered LPW modules.</li>
</ol>
<h1><a class="anchor" id="autotoc_md6"></a>
Use the Installer</h1>
<p>Download the lpw_x.x.x.x_installer.exe. It's a self-installing archive that includes the LPW binaries and documents. It also helps installing the VC++ Redistributable Package and registering the LPW dlls.</p>
<h1><a class="anchor" id="autotoc_md7"></a>
Licensing</h1>
<h3><a class="anchor" id="autotoc_md8"></a>
Trial Version: Use License File</h3>
<ol type="1">
<li>Run <b>lpvKeyTool.exe</b> under the installed runner folder(either runner/x64 or runner/86). It generates a <b>lpv.key</b> file.</li>
<li>Send the generated lpv.key file to us or your LPW SDK Tech Support. We will send you back a <b>lpv.lic</b> file.</li>
<li>You may use any of the following approach to deploy the license file:</li>
</ol>
<ul>
<li>Put the license file under the root runner folder(./runner), and with the exactly name "lpv.lic".</li>
<li>Put the license file under the user folder(AppData%/LPV), and with the exactly name "lpv.lic".</li>
<li>Open any demo application, it will pop up the unlicensed warning dialog, click YES and upload the lpv.lic file, we will copy it for you to the right folder.</li>
</ul>
<p><em>Note: This approach is only for short-term evaluation, you'll be notified when the trial period expired, please contact us or your LPW SDK Tech Support.</em></p>
<h3><a class="anchor" id="autotoc_md9"></a>
Full Version: Use Sentinel Protection Key</h3>
<ol type="1">
<li>Plug in the Sentinel Protection Key of LPW. Make sure the key lights up.</li>
<li>Open any demo application to see it if it works as expected.</li>
</ol>
<h3><a class="anchor" id="autotoc_md10"></a>
Full Version: Use Sense Protection Key</h3>
<ol type="1">
<li>Download then install the Sense driver from the <a href="https://lm.virbox.com/tools.html">official site</a> or our download link <a href="http://fileserver.hzleaper.com:8086/f/210d89dee4674fb98469/">here</a>.</li>
<li>Plug in the Sense Protection Key of LPW. Make sure the key lights up.</li>
<li>Open any demo application to see it if it works as expected.</li>
</ol>
<p><br  />
 </p><hr  />
<h1><a class="anchor" id="autotoc_md11"></a>
Integration</h1>
<h2><a class="anchor" id="autotoc_md12"></a>
Add LPW Libraries to Visual Studio Projects</h2>
 <div class='newInnerHTML' title='csharp' style='display: none;'>C#</div><div class='toggleable_div label_csharp' style='display: none;'><ol type="1">
<li>RMC your C# project, click "Add Reference"</li>
<li>Under COM -&gt; Type Libraries panel, search and find <a class="el" href="namespace_l_p_v_core_lib.html" title="LPV Core Library, provide basic functionalities.">LPVCoreLib</a> (must-have), <a class="el" href="namespace_l_p_v_geom_lib.html" title="LPV Geometry Library, provide geometric functionalities.">LPVGeomLib</a> (must-have) and other LPVXXXLibs according to your application, then click OK to add reference (and Interop) to them in your project.</li>
<li>In your code, add the line <code>using LPVXXXLib;</code> to start using the LPW classes.<br  />
The following code show a short example: <div class="fragment"><div class="line"><span class="comment">// add using.</span></div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_l_p_v_core_lib.html">LPVCoreLib</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_l_p_v_geom_lib.html">LPVGeomLib</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespace_l_p_v_pat_lib.html">LPVPatLib</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// add definition of @projectname class.</span></div>
<div class="line">LMatch m_lmatch = <span class="keyword">new</span> LMatch();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// call @projectname functions, such as set pattern matching&#39;s maximum count, or angle tolerance.</span></div>
<div class="line">m_lmatch.MaxCount = 1;</div>
<div class="line">m_lmatch.AngleTolerance = 180;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// call @projectname functions and handle the returned error code, such as do pattern matching.</span></div>
<div class="line"><a class="code" href="namespace_l_p_v_core_lib.html#a753df57c2ab9773ee9dff5747163ee4a">LPVErrorCode</a> errCode = m_lmatch.Match(m_source_img, (LRegion)m_roi, out m_match_results);</div>
<div class="line"><span class="keywordflow">if</span> (errCode != <a class="code" href="namespace_l_p_v_core_lib.html#a753df57c2ab9773ee9dff5747163ee4a">LPVErrorCode</a>.LPVNoError) {}</div>
<div class="ttc" id="anamespace_l_p_v_core_lib_html"><div class="ttname"><a href="namespace_l_p_v_core_lib.html">LPVCoreLib</a></div><div class="ttdoc">LPV Core Library, provide basic functionalities.</div><div class="ttdef"><b>Definition:</b> LPVCore.idl:106</div></div>
<div class="ttc" id="anamespace_l_p_v_core_lib_html_a753df57c2ab9773ee9dff5747163ee4a"><div class="ttname"><a href="namespace_l_p_v_core_lib.html#a753df57c2ab9773ee9dff5747163ee4a">LPVCoreLib::LPVErrorCode</a></div><div class="ttdeci">LPVErrorCode</div><div class="ttdoc">This enumeration represents the type of a LPV function error.</div><div class="ttdef"><b>Definition:</b> LPVCore.idl:194</div></div>
<div class="ttc" id="anamespace_l_p_v_geom_lib_html"><div class="ttname"><a href="namespace_l_p_v_geom_lib.html">LPVGeomLib</a></div><div class="ttdoc">LPV Geometry Library, provide geometric functionalities.</div><div class="ttdef"><b>Definition:</b> LPVGeom.idl:50</div></div>
<div class="ttc" id="anamespace_l_p_v_pat_lib_html"><div class="ttname"><a href="namespace_l_p_v_pat_lib.html">LPVPatLib</a></div><div class="ttdoc">LPV Pattern Library, provides functionality for pattern matching.</div><div class="ttdef"><b>Definition:</b> LPVPat.idl:50</div></div>
</div><!-- fragment --></li>
</ol>
 </div>  <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'><p>It's recommended to use <a href="https://docs.microsoft.com/zh-cn/cpp/cpp/compiler-com-support"><b>Compiler COM Support</b></a> to directly read LPW modules out and convert it to C++ headers. Then you can use the COM interfaces as classes.</p>
<ol type="1">
<li>Call <a href="https://docs.microsoft.com/en-us/windows/win32/api/combaseapi/nf-combaseapi-coinitializeex">CoInitializeEx</a> when your program starts and <a href="https://docs.microsoft.com/en-us/windows/win32/api/combaseapi/nf-combaseapi-couninitialize">CoUnitialize</a> when it terminates. If you create and host LPW classes in threads, you should also call the two functions when the thread start and finish its job. You should do it before create and initialize LPW classes. For example, for a MFC application, the best place to do this is in InitInstance and ExitInstance, as following: <div class="fragment"><div class="line">BOOL CMFCApp::InitInstance()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// You may use COINIT_MULTITHREADED or COINIT_APARTMENTTHREADED based on the requirement of your application.</span></div>
<div class="line">    <span class="comment">// For example, use COINIT_APARTMENTTHREADED for MFC application, COINIT_MULTITHREADED for other cases.</span></div>
<div class="line">    <span class="comment">// If you are not sure, read more in https://docs.microsoft.com/en-us/windows/win32/learnwin32/initializing-the-com-library</span></div>
<div class="line">    CoInitializeEx(NULL, COINIT_APARTMENTTHREADED);</div>
<div class="line">    <span class="comment">// etc.</span></div>
<div class="line">    CWinApp::InitInstance();</div>
<div class="line">}</div>
<div class="line">INT CMFCApp::ExitInstance()</div>
<div class="line">{</div>
<div class="line">    CoUninitialize();</div>
<div class="line">    <span class="keywordflow">return</span> CWinApp::ExitInstance();</div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li>Use <a href="@https://docs.microsoft.com/en-us/cpp/preprocessor/hash-import-directive-cpp">#import directive</a> to incorporate information from LPW libraries, including <a class="el" href="namespace_l_p_v_core_lib.html" title="LPV Core Library, provide basic functionalities.">LPVCoreLib</a> (must-have), <a class="el" href="namespace_l_p_v_geom_lib.html" title="LPV Geometry Library, provide geometric functionalities.">LPVGeomLib</a> (must-have) and other required LPVXXXLibs.<br  />
For example, to import LPVCore library: <div class="fragment"><div class="line"><span class="comment">// use the include file under &quot;demo/include&quot; folder</span></div>
<div class="line"><span class="comment">// You may firstly copy &quot;demo/include&quot; folder to your project folder, or add the folder to your project&#39;s include path</span></div>
<div class="line"><span class="preprocessor">#include &quot;LPVCore.h&quot;</span></div>
</div><!-- fragment --> -or- <div class="fragment"><div class="line"><span class="comment">// use the file path of the library</span></div>
<div class="line"><span class="preprocessor">#import &quot;Y:\\runner\\x86\\lpvCore.dll&quot;</span></div>
</div><!-- fragment --> -or- <div class="fragment"><div class="line"><span class="comment">// use the progid of one class in the library</span></div>
<div class="line"><span class="preprocessor">#import &quot;progid:LPV.LImage&quot;</span></div>
</div><!-- fragment --> -or- <div class="fragment"><div class="line"><span class="comment">// use the uuid of the library, you can find the id via OLE/COM Object Viewer.</span></div>
<div class="line"><span class="preprocessor">#import &quot;libid:c34b3e9e-6dea-4aa9-b500-0266f90dc15f&quot;</span></div>
</div><!-- fragment --></li>
<li>Start using the LPW classes.<br  />
The following code show a short example: <div class="fragment"><div class="line"><span class="comment">// import libraries</span></div>
<div class="line"><span class="preprocessor">#include &quot;LPVCore.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;LPVGeom.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;LPVPat.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// add definition of @projectname class and create the instance</span></div>
<div class="line"><span class="comment">// the following code defined an ILMatch interface of a LMatch object,</span></div>
<div class="line">ILMatchPtr m_lmatch(__uuidof(LMatch));</div>
<div class="line"><span class="comment">// or you can call CreateInstance, as following:</span></div>
<div class="line"><span class="comment">// ILMatchPtr m_lmatch;</span></div>
<div class="line"><span class="comment">// do something like initialization of other data members, and later create the instance</span></div>
<div class="line"><span class="comment">// ...</span></div>
<div class="line"><span class="comment">// m_lmatch.CreateInstance(__uuidof(LMatch));</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// set properties, such as set pattern matching&#39;s maximum count, or angle tolerance.</span></div>
<div class="line">m_lmatch-&gt;MaxCount = 1;</div>
<div class="line">m_lmatch-&gt;AngleTolerance = 180;</div>
<div class="line">    </div>
<div class="line"><span class="comment">// call functions and handle the returned error code, such as do pattern matching.</span></div>
<div class="line"><a class="code" href="namespace_l_p_v_core_lib.html#a753df57c2ab9773ee9dff5747163ee4a">LPVErrorCode</a> errCode = m_lmatch-&gt;Match(m_source_img, m_roi, &amp;m_match_results);</div>
<div class="line"><span class="keywordflow">if</span> (errCode != LPVErrorCode::LPVNoError) {</div>
<div class="line">    <span class="comment">// handle error</span></div>
<div class="line">}</div>
</div><!-- fragment --></li>
</ol>
<p>Alternatively for Qt applications, you could use <b>Active Qt</b> to generate QAxObject wrappers for LPW classes, please follow the QT's <a href="https://doc.qt.io/qt-5/activeqt-container.html">official guide</a>.</p>
 </div>  </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
© 2022 <a href="http://www.hzleaper.com/">Hangzhou Leaper Tech. Ltd.</a>
</small></address>
<script type="text/javascript">
//<![CDATA[
addTutorialsButtons();
//]]>
</script>
</body>
</html>
